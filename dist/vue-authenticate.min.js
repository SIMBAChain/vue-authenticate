/**
 * vue-authenticate v1.4.1
 * https://github.com/dgrubelic/vue-authenticate
 * Released under the MIT License.
 * 
 */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).VueAuthenticate=e()}(this,function(){"use strict";function o(t){return void 0===t}function s(t){return"function"==typeof t}function p(e,o){return null==e||null==o||Object.keys(o).forEach(function(t){"[object Object]"!=Object.prototype.toString.call(o[t])||"[object Object]"!=Object.prototype.toString.call(e[t])?e[t]=o[t]:e[t]=p(e[t],o[t])}),e}function a(t,e){if(/^(?:[a-z]+:)?\/\//i.test(e))return e;var o=[t,e].join("/");return o.replace(/[\/]+/g,"/").replace(/\/\?/g,"?").replace(/\/\#/g,"#").replace(/\:\//g,"://")}function u(t){var e="https:"===t.protocol;return t.protocol+"//"+t.hostname+":"+(t.port||(e?"443":"80"))+(/^\//.test(t.pathname)?t.pathname:"/"+t.pathname)}function h(t){var e,o,r={};return(t||"").split("&").forEach(function(t){t&&(o=t.split("="),e=decodeURIComponent(o[0]),r[e]=!o[1]||decodeURIComponent(o[1]))}),r}function r(t){var e;if("undefined"!=typeof module&&module.exports)try{e=require("buffer").Buffer}catch(t){}function o(t){switch(t.length){case 4:var e=((7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3))-65536;return r(55296+(e>>>10))+r(56320+(1023&e));case 3:return r((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return r((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}}var r=String.fromCharCode,n=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g");return(e?function(t){return(t.constructor===e.constructor?t:new e(t,"base64")).toString()}:function(t){return atob(t).replace(n,o)})(String(t).replace(/[-_]/g,function(t){return"-"===t?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))}function n(t,e,o){return[encodeURIComponent(t),"=",encodeURIComponent(e),(n=(r=o).path,i=r.domain,s=r.expires,a=r.secure,[null==n?"":";path="+n,null==i?"":";domain="+i,null==s?"":";expires="+s.toUTCString(),null==a||!1===a?"":";secure"].join(""))].join("");var r,n,i,s,a}function i(t,e,o,r){return(t=t||{}).url=t.url?t.url:a(this.options.baseUrl,this.options.loginUrl),t[this.options.requestDataKey]=r||t[this.options.requestDataKey],t.method=t.method||"POST",t.withCredentials=t.withCredentials||this.options.withCredentials,t}"function"!=typeof Object.assign&&(Object.assign=function(t,e){var o=arguments;if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(t),n=1;n<arguments.length;n++){var i=o[n];if(null!=i)for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])}return r});var e=setTimeout;function c(){}function l(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],y(t,this)}function f(o,r){for(;3===o._state;)o=o._value;0!==o._state?(o._handled=!0,l._immediateFn(function(){var t=1===o._state?r.onFulfilled:r.onRejected;if(null!==t){var e;try{e=t(o._value)}catch(t){return void g(r.promise,t)}d(r.promise,e)}else(1===o._state?d:g)(r.promise,o._value)})):o._deferreds.push(r)}function d(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var o=t.then;if(t instanceof l)return e._state=3,e._value=t,void m(e);if("function"==typeof o)return void y((r=o,n=t,function(){r.apply(n,arguments)}),e)}e._state=1,e._value=t,m(e)}catch(t){g(e,t)}var r,n}function g(t,e){t._state=2,t._value=e,m(t)}function m(t){2===t._state&&0===t._deferreds.length&&l._immediateFn(function(){t._handled||l._unhandledRejectionFn(t._value)});for(var e=0,o=t._deferreds.length;e<o;e++)f(t,t._deferreds[e]);t._deferreds=null}function v(t,e,o){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=o}function y(t,e){var o=!1;try{t(function(t){o||(o=!0,d(e,t))},function(t){o||(o=!0,g(e,t))})}catch(t){if(o)return;o=!0,g(e,t)}}l.prototype.catch=function(t){return this.then(null,t)},l.prototype.then=function(t,e){var o=new this.constructor(c);return f(this,new v(t,e,o)),o},l.all=function(t){var a=Array.prototype.slice.call(t);return new l(function(r,n){if(0===a.length)return r([]);var i=a.length;function s(e,t){try{if(t&&("object"==typeof t||"function"==typeof t)){var o=t.then;if("function"==typeof o)return void o.call(t,function(t){s(e,t)},n)}a[e]=t,0==--i&&r(a)}catch(t){n(t)}}for(var t=0;t<a.length;t++)s(t,a[t])})},l.resolve=function(e){return e&&"object"==typeof e&&e.constructor===l?e:new l(function(t){t(e)})},l.reject=function(o){return new l(function(t,e){e(o)})},l.race=function(n){return new l(function(t,e){for(var o=0,r=n.length;o<r;o++)n[o].then(t,e)})},l._immediateFn="function"==typeof setImmediate?function(t){setImmediate(t)}:function(t){e(t,0)},l._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},l._setImmediateFn=function(t){l._immediateFn=t},l._setUnhandledRejectionFn=function(t){l._unhandledRejectionFn=t};var w=document,k=window;function _(){try{return k.location.hostname}catch(t){}return""}function t(t){try{return o(t)?k.location.origin:""+k.location.origin+t}catch(t){}return t||null}function C(t){this._defaultOptions=p({domain:_(),expires:null,path:"/",secure:!1},t)}var b={baseUrl:null,tokenPath:"access_token",tokenName:"token",tokenPrefix:"vueauth",tokenHeader:"Authorization",tokenType:"Bearer",refreshType:null,refreshTokenName:"refresh_token",refreshTokenPrefix:null,expirationName:"expiration",expirationPrefix:null,loginUrl:"/auth/login",registerUrl:"/auth/register",logoutUrl:null,refreshUrl:"/auth/login/refresh",storageType:"localStorage",storageNamespace:"vue-authenticate",cookieStorage:{domain:_(),path:"/",secure:!1},requestDataKey:"data",responseDataKey:"data",bindRequestInterceptor:function(e){var o=e.options.tokenHeader;e.$http.interceptors.request.use(function(t){return e.isAuthenticated()?t.headers[o]=[e.options.tokenType,e.getToken()].join(" "):delete t.headers[o],t})},bindResponseInterceptor:function(n){n.$http.interceptors.response.use(function(t){return t},function(t){var e=t.config,o=t.response.status,r=e;return 401===o&&n.options.refreshType&&n.isTokenSet()&&!n._isRefreshing?(n._isRefreshing=!0,n.refresh().then(function(t){return n._isRefreshing=!1,n.$http(r)}).catch(function(t){return n._isRefreshing=!1,Promise.reject(t)})):Promise.reject(t)})},providers:{facebook:{name:"facebook",url:"/auth/facebook",authorizationEndpoint:"https://www.facebook.com/v2.5/dialog/oauth",redirectUri:t("/"),requiredUrlParams:["display","scope"],scope:["email"],scopeDelimiter:",",display:"popup",oauthType:"2.0",popupOptions:{width:580,height:400}},google:{name:"google",url:"/auth/google",authorizationEndpoint:"https://accounts.google.com/o/oauth2/auth",redirectUri:t(),requiredUrlParams:["scope"],optionalUrlParams:["display"],scope:["profile","email"],scopePrefix:"openid",scopeDelimiter:" ",display:"popup",oauthType:"2.0",popupOptions:{width:452,height:633}},github:{name:"github",url:"/auth/github",authorizationEndpoint:"https://github.com/login/oauth/authorize",redirectUri:t(),optionalUrlParams:["scope"],scope:["user:email"],scopeDelimiter:" ",oauthType:"2.0",popupOptions:{width:1020,height:618}},instagram:{name:"instagram",url:"/auth/instagram",authorizationEndpoint:"https://api.instagram.com/oauth/authorize",redirectUri:t(),requiredUrlParams:["scope"],scope:["basic"],scopeDelimiter:"+",oauthType:"2.0",popupOptions:{width:null,height:null}},twitter:{name:"twitter",url:"/auth/twitter",authorizationEndpoint:"https://api.twitter.com/oauth/authenticate",redirectUri:t(),oauthType:"1.0",popupOptions:{width:495,height:645}},bitbucket:{name:"bitbucket",url:"/auth/bitbucket",authorizationEndpoint:"https://bitbucket.org/site/oauth2/authorize",redirectUri:t("/"),optionalUrlParams:["scope"],scope:["email"],scopeDelimiter:" ",oauthType:"2.0",popupOptions:{width:1020,height:618}},linkedin:{name:"linkedin",url:"/auth/linkedin",authorizationEndpoint:"https://www.linkedin.com/oauth/v2/authorization",redirectUri:t(),requiredUrlParams:["state","scope"],scope:["r_emailaddress"],scopeDelimiter:" ",state:"STATE",oauthType:"2.0",popupOptions:{width:527,height:582}},live:{name:"live",url:"/auth/live",authorizationEndpoint:"https://login.live.com/oauth20_authorize.srf",redirectUri:t(),requiredUrlParams:["display","scope"],scope:["wl.emails"],scopeDelimiter:" ",display:"popup",oauthType:"2.0",popupOptions:{width:500,height:560}},oauth1:{name:null,url:"/auth/oauth1",authorizationEndpoint:null,redirectUri:t(),oauthType:"1.0",popupOptions:null},oauth2:{name:null,url:"/auth/oauth2",clientId:null,redirectUri:t(),authorizationEndpoint:null,defaultUrlParams:["response_type","client_id","redirect_uri"],requiredUrlParams:null,optionalUrlParams:null,scope:null,scopePrefix:null,scopeDelimiter:null,state:null,oauthType:"2.0",popupOptions:null,responseType:"code",responseParams:{code:"code",clientId:"clientId",redirectUri:"redirectUri"}}}};C.prototype.setItem=function(t,e){var o=n(t,e,p({},this._defaultOptions));this._setCookie(o)},C.prototype.getItem=function(t){var e=function(t){if(void 0===t&&(t=""),0===t.length)return{};var s={},e=new RegExp("\\s*;\\s*");return t.split(e).forEach(function(t){var e=t.split("="),o=e[0],r=e[1],n=decodeURIComponent(o),i=decodeURIComponent(r);s[n]=i}),s}(this._getCookie());return e.hasOwnProperty(t)?e[t]:null},C.prototype.removeItem=function(t){var e=p({},this._defaultOptions),o=n(t,"",p(e,{expires:new Date(0)}));this._setCookie(o)},C.prototype._getCookie=function(){try{return"undefined"===w.cookie?"":w.cookie}catch(t){}return""},C.prototype._setCookie=function(t){try{w.cookie=t}catch(t){}};function T(t){this.namespace=t||null}T.prototype.setItem=function(t,e){k.localStorage.setItem(this._getStorageKey(t),e)},T.prototype.getItem=function(t){return k.localStorage.getItem(this._getStorageKey(t))},T.prototype.removeItem=function(t){k.localStorage.removeItem(this._getStorageKey(t))},T.prototype._getStorageKey=function(t){return this.namespace?[this.namespace,t].join("."):t};function U(t){this.namespace=t||null,this._storage={}}U.prototype.setItem=function(t,e){this._storage[this._getStorageKey(t)]=e},U.prototype.getItem=function(t){return this._storage[this._getStorageKey(t)]},U.prototype.removeItem=function(t){delete this._storage[this._getStorageKey(t)]},U.prototype._getStorageKey=function(t){return this.namespace?[this.namespace,t].join("."):t};function I(t,e,o){this.popup=null,this.url=t,this.name=e,this.popupOptions=o}I.prototype.open=function(t,e){try{return this.popup=k.open(this.url,this.name,this._stringifyOptions()),this.popup&&this.popup.focus&&this.popup.focus(),e?l.resolve():this.pooling(t)}catch(t){return l.reject(new Error("OAuth popup error occurred"))}},I.prototype.pooling=function(e){var a=this;return new l(function(r,n){var t=w.createElement("a");t.href=e;var i=u(t),s=setInterval(function(){a.popup&&!a.popup.closed&&void 0!==a.popup.closed||(clearInterval(s),s=null,n(new Error("Auth popup window closed")));try{if(u(a.popup.location)===i){if(a.popup.location.search||a.popup.location.hash){var t=h(a.popup.location.search.substring(1).replace(/\/$/,"")),e=h(a.popup.location.hash.substring(1).replace(/[\/$]/,"")),o=p({},t);(o=p(o,e)).error?n(new Error(o.error)):r(o)}else n(new Error("OAuth redirect has occurred but no query or hash parameters were found."));clearInterval(s),s=null,a.popup.close()}}catch(t){}},250)})},I.prototype._stringifyOptions=function(){var t=[];for(var e in this.popupOptions)o(this.popupOptions[e])||t.push(e+"="+this.popupOptions[e]);return t.join(",")};function P(t,e,o,r){this.$http=t,this.storage=e,this.providerConfig=p({},j),this.providerConfig=p(this.providerConfig,o),this.options=r}var j={name:null,url:null,authorizationEndpoint:null,scope:null,scopePrefix:null,scopeDelimiter:null,redirectUri:null,requiredUrlParams:null,defaultUrlParams:null,oauthType:"1.0",popupOptions:{}};P.prototype.init=function(e){var o=this;return this.oauthPopup=new I("about:blank",this.providerConfig.name,this.providerConfig.popupOptions),k.cordova||this.oauthPopup.open(this.providerConfig.redirectUri,!0),this.getRequestToken().then(function(t){return o.openPopup(t).then(function(t){return o.exchangeForToken(t,e)})})},P.prototype.getRequestToken=function(){var t={method:"POST"};return t[this.options.requestDataKey]=p({},this.providerConfig),t.withCredentials=this.options.withCredentials,this.options.baseUrl?t.url=a(this.options.baseUrl,this.providerConfig.url):t.url=this.providerConfig.url,this.$http(t)},P.prototype.openPopup=function(t){var e=[this.providerConfig.authorizationEndpoint,this.buildQueryString(t[this.options.responseDataKey])].join("?");return this.oauthPopup.popup.location=e,k.cordova?this.oauthPopup.open(this.providerConfig.redirectUri):this.oauthPopup.pooling(this.providerConfig.redirectUri)},P.prototype.exchangeForToken=function(t,e){var o=p({},e);o=p(o,t);var r={method:"POST"};return r[this.options.requestDataKey]=o,r.withCredentials=this.options.withCredentials,this.options.baseUrl?r.url=a(this.options.baseUrl,this.providerConfig.url):r.url=this.providerConfig.url,this.$http(r)},P.prototype.buildQueryString=function(t){var e=[];for(var o in t){var r=t[o];e.push(encodeURIComponent(o)+"="+encodeURIComponent(r))}return e.join("&")};function x(t,e,o,r){this.$http=t,this.storage=e,this.providerConfig=p({},O),this.providerConfig=p(this.providerConfig,o),this.options=r}var O={name:null,url:null,clientId:null,authorizationEndpoint:null,redirectUri:null,scope:null,scopePrefix:null,scopeDelimiter:null,state:null,requiredUrlParams:null,defaultUrlParams:["response_type","client_id","redirect_uri"],responseType:"code",responseParams:{code:"code",clientId:"clientId",redirectUri:"redirectUri"},oauthType:"2.0",popupOptions:{}};x.prototype.init=function(r){var n=this,i=this.providerConfig.name+"_state";s(this.providerConfig.state)?this.storage.setItem(i,this.providerConfig.state()):"string"==typeof this.providerConfig.state&&this.storage.setItem(i,this.providerConfig.state);var t=[this.providerConfig.authorizationEndpoint,this._stringifyRequestParams()].join("?");return this.oauthPopup=new I(t,this.providerConfig.name,this.providerConfig.popupOptions),new Promise(function(e,o){n.oauthPopup.open(n.providerConfig.redirectUri).then(function(t){return"token"!==n.providerConfig.responseType&&n.providerConfig.url?t.state&&t.state!==n.storage.getItem(i)?o(new Error("State parameter value does not match original OAuth request state value")):void e(n.exchangeForToken(t,r)):e(t)}).catch(function(t){o(t)})})},x.prototype.exchangeForToken=function(t,e){var o,r=p({},e);for(var n in this.providerConfig.responseParams){var i=this.providerConfig.responseParams[n];switch(n){case"code":r[i]=t.code;break;case"clientId":r[i]=this.providerConfig.clientId;break;case"redirectUri":r[i]=this.providerConfig.redirectUri;break;default:r[i]=t[n]}}return t.state&&(r.state=t.state),o=this.options.baseUrl?a(this.options.baseUrl,this.providerConfig.url):this.providerConfig.url,this.$http.post(o,r,{withCredentials:this.options.withCredentials})},x.prototype._stringifyRequestParams=function(){var n=this,i=[];return["defaultUrlParams","requiredUrlParams","optionalUrlParams"].forEach(function(t){n.providerConfig[t]&&Array.isArray(n.providerConfig[t])&&n.providerConfig[t].forEach(function(t){var e=t.replace(/([\:\-\_]+(.))/g,function(t,e,o,r){return r?o.toUpperCase():o}),o=s(n.providerConfig[t])?n.providerConfig[t]():n.providerConfig[e];if("redirect_uri"!==t||o){if("state"===t){var r=n.providerConfig.name+"_state";o=encodeURIComponent(n.storage.getItem(r))}"scope"===t&&Array.isArray(o)&&(o=o.join(n.providerConfig.scopeDelimiter),n.providerConfig.scopePrefix&&(o=[n.providerConfig.scopePrefix,o].join(n.providerConfig.scopeDelimiter))),i.push([t,o])}})}),i.map(function(t){return t.join("=")}).join("&")};var E=function(t,e){var o=p({},b),r=function(t){switch(t.storageType){case"localStorage":try{return k.localStorage.setItem("testKey","test"),k.localStorage.removeItem("testKey"),new T(t.storageNamespace)}catch(t){}case"sessionStorage":try{return k.sessionStorage.setItem("testKey","test"),k.sessionStorage.removeItem("testKey"),new LocalStorage(t.storageNamespace)}catch(t){}case"cookieStorage":return new C(t.cookieStorage);case"memoryStorage":default:return new U(t.storageNamespace)}}(o=p(o,e));if(Object.defineProperties(this,{$http:{get:function(){return t}},options:{get:function(){return o}},storage:{get:function(){return r}},tokenName:{get:function(){return this.options.tokenPrefix?[this.options.tokenPrefix,this.options.tokenName].join("_"):this.options.tokenName}},refreshTokenName:{get:function(){return this.options.refreshTokenPrefix?[this.options.refreshTokenPrefix,this.options.refreshTokenName].join("_"):this.options.refreshTokenName}},expirationName:{get:function(){return this.options.expirationPrefix?[this.options.expirationPrefix,this.options.expirationName].join("_"):this.options.expirationName}}}),!this.options.bindRequestInterceptor||!s(this.options.bindRequestInterceptor))throw new Error("Request interceptor must be functions");if(this.options.bindRequestInterceptor.call(this,this),!this.options.bindResponseInterceptor||!s(this.options.bindResponseInterceptor))throw new Error("Response interceptor must be functions");this.options.bindResponseInterceptor.call(this,this)};function R(t,e){if(!R.installed){R.installed=!0;var o=null;Object.defineProperties(t.prototype,{$auth:{get:function(){if(!o){if(!this.$http)throw new Error("Request handler instance not found");o=new E(this.$http,e)}return o}}})}}return E.prototype.isAuthenticated=function(){var t,e=this.storage.getItem(this.tokenName);if(e){if(3===e.split(".").length)try{var o=(t=e.split(".")[1].replace("-","+").replace("_","/"),JSON.parse(window.atob(t)).exp);if("number"==typeof o)return Math.round((new Date).getTime()/1e3)<o}catch(t){return!0}return!0}return!1},E.prototype.isTokenSet=function(){return!o(this.getToken())&&!!this.getToken()},E.prototype.getToken=function(){return this.storage.getItem(this.tokenName)},E.prototype.setToken=function(t,e){t[this.options.responseDataKey]&&(t=t[this.options.responseDataKey]);var o=function(t,e){for(var o,r=void 0,n=t,i=e.split("."),s=0;s<i.length;s++){var a=i[s];if(r=n[a],null===(o=r)||"object"!=typeof o)break;n=n[a]}return r}(t,e||this.options.tokenPath);o&&this.storage.setItem(this.tokenName,o)},E.prototype.getRefreshToken=function(){return"storage"===this.options.refreshType?this.storage.getItem(this.refreshTokenName):null},E.prototype.getExpiration=function(){return this.options.refreshType?this.storage.getItem(this.expirationName):null},E.prototype.setRefreshToken=function(t){var e;if(this.options.refreshType)return t[this.options.responseDataKey]&&(t=t[this.options.responseDataKey]),this.setExpiration(t),"storage"!==this.options.refreshType||(t.refresh_token&&(e=t.refresh_token),!e&&t&&(e=t[this.options.expirationName]),e&&this.storage.setItem(this.refreshTokenName,e)),t},E.prototype.setExpiration=function(t){var e;if(t.expires_in){var o=parseInt(t.expires_in);isNaN(o)&&(o=0),e=Math.round((new Date).getTime()/1e3)+o}if(!e&&t){var r=parseInt(t[this.options.expirationName]);isNaN(r)&&(r=0),e=Math.round((new Date).getTime()/1e3)+r}return e&&this.storage.setItem(this.expirationName,e),t},E.prototype.getPayload=function(){var t=this.storage.getItem(this.tokenName);if(t&&3===t.split(".").length)try{var e=t.split(".")[1].replace("-","+").replace("_","/");return JSON.parse(r(e))}catch(t){}},E.prototype.login=function(t,e){var o=this;return e=i(e,this.options,0,t),this.$http(e).then(function(t){if(o.setToken(t),o.setRefreshToken(t),o.isAuthenticated())return l.resolve(t);throw new Error("Server did not provided an access token.")}).catch(function(t){return l.reject(t)})},E.prototype.register=function(t,e){var o=this;return e=i(e,this.options,0,t),this.$http(e).then(function(t){return o.setToken(t),o.setRefreshToken(t),l.resolve(t)}).catch(function(t){return l.reject(t)})},E.prototype.logout=function(t){var e=this;return this.isAuthenticated()?(t=t||{}).url||this.options.logoutUrl?(t.url=t.url?t.url:a(this.options.baseUrl,this.options.logoutUrl),t.method=t.method||"POST",t[this.options.requestDataKey]=t[this.options.requestDataKey]||void 0,t.withCredentials=t.withCredentials||this.options.withCredentials,this.$http(t).then(function(t){return e.storage.removeItem(e.tokenName),l.resolve(t)}).catch(function(t){return l.reject(t)})):(this.storage.removeItem(this.tokenName),l.resolve()):l.reject(new Error("There is no currently authenticated user"))},E.prototype.refresh=function(t){var e=this;if(!this.options.storageType)throw new Error("Refreshing is not set");var o={};return"storage"===this.options.refreshType&&(o.refresh_token=this.getRefreshToken()),t=i(t,this.options,0,o),this.$http(t).then(function(t){return e.setToken(t),e.setRefreshToken(t),l.resolve(t)}).catch(function(t){return e.clearStorage(),l.reject(t)})},E.prototype.clearStorage=function(){this.storage.removeItem(this.tokenName),this.storage.removeItem(this.expirationName),this.storage.removeItem(this.refreshTokenName)},E.prototype.authenticate=function(n,i){var s=this;return new l(function(e,o){var t,r=s.options.providers[n];if(!r)return o(new Error("Unknown provider"));switch(r.oauthType){case"1.0":t=new P(s.$http,s.storage,r,s.options);break;case"2.0":t=new x(s.$http,s.storage,r,s.options);break;default:return o(new Error("Invalid OAuth type"))}return t.init(i).then(function(t){return s.setToken(t,r.tokenPath),s.isAuthenticated()?e(t):o(new Error("Authentication failed"))}).catch(function(t){return o(t)})})},E.prototype.link=function(n,i){var s=this;return new l(function(e,t){var o,r=s.options.providers[n];if(!r)return t(new Error("Unknown provider"));switch(r.oauthType){case"1.0":o=new P(s.$http,s.storage,r,s.options);break;case"2.0":o=new x(s.$http,s.storage,r,s.options);break;default:return t(new Error("Invalid OAuth type"))}return o.init(i).then(function(t){t[s.options.responseDataKey]&&(t=t[s.options.responseDataKey]),e(t)}).catch(t)})},R.factory=function(t,e){return new E(t,e)},R});
